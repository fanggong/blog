---
title: ggplot2使用笔记（2）—— Stat和Geom
author: Fang Yongchao
date: "2021-03-23"
output:
  blogdown::html_page:
    toc: yes
    toc_depth: 2
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#对连续变量x的各区间的样本数量进行统计作图">对连续变量x的各区间的样本数量进行统计作图</a></li>
<li><a href="#对离散变量x的各类别数量进行统计作图">对离散变量x的各类别数量进行统计作图</a></li>
<li><a href="#计算连续变量x的密度曲线并作图">计算连续变量x的密度曲线并作图</a></li>
<li><a href="#对区域中点的数量进行统计作图">对区域中点的数量进行统计作图</a></li>
<li><a href="#对xy作分位数回归并作图">对x，y作分位数回归并作图</a></li>
<li><a href="#计算并绘制xy的拟合曲线">计算并绘制x，y的拟合曲线</a></li>
<li><a href="#在离散变量x的各类别上对连续变量y进行统计作图">在离散变量x的各类别上对连续变量y进行统计作图</a></li>
<li><a href="#计算连续变量y的密度曲线并作图">计算连续变量y的密度曲线并作图</a></li>
<li><a href="#对每个点上点的数量进行统计作图">对每个点上点的数量进行统计作图</a></li>
<li><a href="#计算并绘制等高线">计算并绘制等高线</a></li>
<li><a href="#在x上对y进行summary并作图">在x上对y进行summary并作图</a></li>
<li><a href="#在x和y上对z进行summary并作图">在x和y上对z进行summary并作图</a></li>
<li><a href="#通过x和函数fun计算yfunx并绘制曲线">通过x和函数fun()计算y=fun(x)并绘制曲线</a></li>
<li><a href="#计算并绘制x的经验累计分布函数">计算并绘制x的经验累计分布函数</a></li>
<li><a href="#计算并绘制q-q图">计算并绘制Q-Q图</a></li>
<li><a href="#二维核密度估计并作图">二维核密度估计并作图</a></li>
<li><a href="#绘制空的坐标系">绘制空的坐标系</a></li>
<li><a href="#绘制带箭头曲线直线">绘制带箭头曲线/直线</a></li>
<li><a href="#绘制折线">绘制折线</a></li>
<li><a href="#绘制多边形">绘制多边形</a></li>
<li><a href="#绘制长方形">绘制长方形</a></li>
<li><a href="#绘制区域">绘制区域</a></li>
<li><a href="#绘制直线">绘制直线</a></li>
<li><a href="#添加标签文本">添加标签/文本</a></li>
<li><a href="#绘制偏离原位置的点">绘制偏离原位置的点</a></li>
<li><a href="#绘制散点图">绘制散点图</a></li>
<li><a href="#在图的四周绘制点的一维投影">在图的四周绘制点的一维投影</a></li>
<li><a href="#绘制区间">绘制区间</a></li>
<li><a href="#绘制地图">绘制地图</a></li>
<li><a href="#绘制点阵图">绘制点阵图</a></li>
<li><a href="#不明白作用的函数">不明白作用的函数</a></li>
</ul>
</div>

<p>以下是一些个人看法。</p>
<p><a href="https://ggplot2.tidyverse.org/">ggplot2</a>中以geom开头的函数可以理解为作图函数，以stat开头的函数可以理解为统计变换函数。在<strong>大部分的情况</strong>下，作图函数和统计变换函数都是成对出现的，也就是说在geom函数中会有一个<strong>stat</strong>参数，而stat函数中也会有一个<strong>geom</strong>参数，从而可以通过geom或stat函数一次性达到对数据进行统计变换并作图的目的。这也是我在最初很迷这个包的原因，因为在一些很奇葩的搭配下可能会出现一些很有趣的图形，虽然图形并不一定有意义，但是思考这个图形背后形成的过程是一件很有意思的事情。</p>
<div id="对连续变量x的各区间的样本数量进行统计作图" class="section level2">
<h2>对连续变量x的各区间的样本数量进行统计作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y(count, density, ncount, ndensity)</strong></li>
<li><strong>binwidth</strong>：每一个柱的宽度</li>
<li><strong>bins</strong>：柱的数量</li>
<li><strong>center</strong>、<strong>boundary</strong>：若<strong>center</strong>设为“t”，则有一根柱以“t”为中线；若<strong>boundary</strong>设为“t”，则有一根柱以“t”为边线</li>
<li><strong>breaks</strong>：直接设定每一根柱的边线位置，该参数会覆盖以上所有参数</li>
<li><strong>closed</strong>：若为“right”，处于交界处的值属于右边的柱子；若为“left”，处于交界处的值属于左边的柱子</li>
<li><strong>pad</strong>：是否在图的左右两侧加空白，若为“TRUE”，最后呈现的图从高度为0的柱开始到高度为0的柱结束</li>
<li><strong>x</strong>应该是连续的，离散的<strong>x</strong>使用<code>stat_count()</code></li>
</ul>
<div id="stat_bin" class="section level3">
<h3><code>stat_bin()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(hwy)) + 
  stat_bin(aes(y = ..density..), binwidth = 1, boundary = 0, pad = TRUE)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-2-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_freqpoly" class="section level3">
<h3><code>geom_freqpoly()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(hwy)) + 
  geom_freqpoly(binwidth = 1)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-3-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_histogram" class="section level3">
<h3><code>geom_histogram()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(hwy)) + 
  geom_histogram(binwidth = 1, boundary = 0.5)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-4-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="对离散变量x的各类别数量进行统计作图" class="section level2">
<h2>对离散变量x的各类别数量进行统计作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y(count,prop)</strong></li>
<li><strong>width</strong>：柱子的宽度，默认两个柱中线距离的90%</li>
<li>当<strong>y</strong>取“prop”时需要配合<strong>group</strong>使用，具体意义 ##TODO</li>
<li><strong>x</strong>应该是离散的，当然，任何连续的都可以看成是离散的</li>
</ul>
<div id="stat_count" class="section level3">
<h3><code>stat_count()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(fl)) + 
  stat_count(width = 0.6)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-5-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_bar" class="section level3">
<h3><code>geom_bar()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(fl)) + 
  geom_bar()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-6-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_col" class="section level3">
<h3><code>geom_col()</code></h3>
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li>类似<code>geom_bar()</code>，但是柱的高度并不是对<strong>x</strong>的计数，而是<strong>y</strong>的和</li>
</ul>
<pre class="r"><code>dat &lt;- tibble(long = rep(1:5, c(1:5)), lat = 1)
ggplot(dat, aes(long, lat)) + geom_col()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-7-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="计算连续变量x的密度曲线并作图" class="section level2">
<h2>计算连续变量x的密度曲线并作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y(density, count, scaled, ndensity)</strong></li>
<li><strong>bw</strong>：可以为数字，意义类似于<strong>binwidth</strong>；可以为字符串，表示方法</li>
<li><strong>adjust</strong>：对<strong>bw</strong>进行调整，不知道有什么用</li>
<li><strong>kernel</strong>：“gaussian”，“epanechnikov”，“rectangular”，“triangular”，“biweight”，“cosine”，“optcosine”</li>
<li><strong>n</strong>：估计时使用的点的数量，需要为2的n次方</li>
<li><strong>trim</strong>：##TODO</li>
<li><code>stat_density()</code>的默认作图是<code>geom_area()</code>，所以最终图并不是曲线而是填充的图</li>
</ul>
<div id="stat_density" class="section level3">
<h3><code>stat_density()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(hwy)) + 
  stat_density(kernel = &quot;epanechnikov&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-8-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_density" class="section level3">
<h3><code>geom_density()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(hwy)) + 
  geom_density(kernel = &quot;gaussian&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-9-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="对区域中点的数量进行统计作图" class="section level2">
<h2>对区域中点的数量进行统计作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li><strong>binwidth</strong>：给出每个小区域的<code>c(水平方向长度, 竖直方向长度)</code></li>
<li><strong>bins</strong>：给出<code>c(水平方向小区域块的数量, 竖直方向小区域块的数量)</code></li>
<li><strong>drop</strong>：是否不显示点的个数为零的区域</li>
<li>对于连续变量，通过区域填充颜色来体现区域内点的个数，当图中点数过多的时候很有用</li>
<li>只有<code>stat_bin_2d()</code>中有<strong>drop</strong>参数，<code>stat_bin_hex()</code>默认<strong>drop</strong>是“TRUE”</li>
</ul>
<div id="stat_bin_2d" class="section level3">
<h3><code>stat_bin_2d()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_bin_2d(binwidth = 1, drop = TRUE)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-10-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_bin_hex" class="section level3">
<h3><code>stat_bin_hex()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_bin_hex(binwidth = 1)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-11-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_bin2d" class="section level3">
<h3><code>geom_bin2d()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_bin2d()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-12-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_hex" class="section level3">
<h3><code>geom_hex()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_hex()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-13-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="对xy作分位数回归并作图" class="section level2">
<h2>对x，y作分位数回归并作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li><strong>quantiles</strong>：<strong>y</strong>的条件分位数</li>
<li><strong>formula</strong>：拟合的公式</li>
<li><strong>method</strong>：分位数回归的方法</li>
<li><strong>method.args</strong>：方法的参数</li>
<li><strong>lineend</strong>：线的终点的样式，可选“round”，“butt”, “square”</li>
<li><strong>linejoin</strong>：线的转折或者说连接处的样式，可选“round”，“mitre”，“bevel”</li>
<li><strong>linemitre</strong>：线的转折/连接处的宽度，这三个参数在正常size的线下几乎没有什么作用</li>
<li><code>stat_quantile()</code>和<code>geom_quantile()</code>并没什么区别</li>
</ul>
<div id="stat_quantile" class="section level3">
<h3><code>stat_quantile()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_quantile(
    quantiles = c(0.1, 0.9), formula = y ~ log(x), method = &quot;rq&quot;
  ) + 
  geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-14-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_quantile" class="section level3">
<h3><code>geom_quantile()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_quantile(quantiles = c(0.1, 0.9), formula = y ~ log(x), method = &quot;rq&quot;) +
  geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-15-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="计算并绘制xy的拟合曲线" class="section level2">
<h2>计算并绘制x，y的拟合曲线</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li><strong>method</strong>：拟合方法</li>
<li><strong>formula</strong>：拟合公式</li>
<li><strong>se</strong>：是否在曲线两边绘制置信区间</li>
<li><strong>n</strong>：用于绘制拟合曲线的点的个数</li>
<li><strong>level</strong>：置信区间的置信水平</li>
<li><strong>method.args</strong>：方法的参数</li>
<li>当点过多且重叠无法看出点的趋势时使用</li>
<li><code>stat_smooth()</code>和<code>geom_smooth()</code>没什么区别</li>
</ul>
<div id="stat_smooth" class="section level3">
<h3><code>stat_smooth()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_smooth(method = &quot;lm&quot;, formula = y ~ x, se = TRUE, level = 0.95) +
  geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-16-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_smooth" class="section level3">
<h3><code>geom_smooth()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_smooth(method = &quot;lm&quot;, formula = y ~ x, se = TRUE, level = 0.95) +
  geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-17-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="在离散变量x的各类别上对连续变量y进行统计作图" class="section level2">
<h2>在离散变量x的各类别上对连续变量y进行统计作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li><strong>outlier.(colour, fill, shape, size, stroke, alpha)</strong>：离群值的颜色，填充色(这个参数貌似并没有用)，形状，大小，轮廓的粗细，透明度</li>
<li><strong>notch</strong>：是否绘制有缺口的箱，有缺口的箱子可以看出数据间中位数的不同</li>
<li><strong>notchwidth</strong>：缺口的宽度，为1时其实就是正常的箱了</li>
<li><strong>varwidth</strong>：数据量的多少是否影响箱的宽度</li>
<li><strong>coef</strong>：线的长度，直接影响哪些值会被判定为离群值</li>
<li><code>stat_boxplot()</code>和<code>geom_boxplot()</code>没有区别</li>
</ul>
<div id="stat_boxplot" class="section level3">
<h3><code>stat_boxplot()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(class, hwy)) + 
  stat_boxplot()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-18-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_boxplot" class="section level3">
<h3><code>geom_boxplot()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(class, hwy)) + 
  geom_boxplot()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-19-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="计算连续变量y的密度曲线并作图" class="section level2">
<h2>计算连续变量y的密度曲线并作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>, <strong>y</strong></li>
<li><strong>bw</strong>：可以为数字，意义类似于<strong>binwidth</strong>；可以为字符串，表示方法</li>
<li><strong>adjust</strong>：对<strong>bw</strong>进行调整</li>
<li><strong>kernel</strong>：“gaussian”, “epanechnikov”, “rectangular”, “triangular”, “biweight”, “cosine”, “optcosine”</li>
<li><strong>scale</strong>：若选择“area”，各个图的面积会一致；若选择“count”，面积会由点的个数决定；若为“width”，会在“count”的基础上强行把宽度一致</li>
<li><strong>trim</strong>：对于提琴的尾部是否进行拉伸处理</li>
<li><code>geom_violin()</code>是<strong>y</strong>的<code>geom_density()</code>和<strong>x</strong>的<code>geom_boxplot()</code>的合体</li>
</ul>
<div id="stat_ydensity" class="section level3">
<h3><code>stat_ydensity()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(class, hwy)) + 
  stat_ydensity(kernel = &quot;gaussian&quot;, scale = &quot;area&quot;, trim = TRUE)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-20-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_violin" class="section level3">
<h3><code>geom_violin()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(class, hwy)) + 
  geom_violin(scale = &quot;width&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-21-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="对每个点上点的数量进行统计作图" class="section level2">
<h2>对每个点上点的数量进行统计作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li>适用于overplot的离散型数据</li>
</ul>
<div id="stat_sum" class="section level3">
<h3><code>stat_sum()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_sum()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-22-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_count" class="section level3">
<h3><code>geom_count()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_count()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-23-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="计算并绘制等高线" class="section level2">
<h2>计算并绘制等高线</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong>，<strong>z</strong></li>
<li><strong>binwidth</strong>、<strong>bins</strong>、<strong>breaks</strong>：类似于<a href="#对连续变量**x**的各区间的样本数量进行统计作图"><code>stat_bin()</code></a>中对应的参数</li>
<li><strong>lineend</strong>：线的终点的样式，可选“round”，“butt”, “square”</li>
<li><strong>linejoin</strong>：线的转折或者说连接处的样式，可选“round”，“mitre”，“bevel”</li>
<li><strong>linemitre</strong>：线的转折/连接处的宽度，这三个参数在正常size的线下几乎没有什么作用</li>
<li>主要作用在于在二维平面上展示第三维的数据</li>
</ul>
<div id="stat_contour" class="section level3">
<h3><code>stat_contour()</code></h3>
<pre class="r"><code>seals &lt;- seals %&gt;% 
  mutate(z = sqrt(delta_long^2 + delta_lat^2))
ggplot(seals, aes(long, lat)) + 
  stat_contour(aes(z = z), bins = 6)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-24-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_contour" class="section level3">
<h3><code>geom_contour()</code></h3>
<pre class="r"><code>ggplot(seals, aes(long, lat)) + 
  geom_contour(aes(z = z))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-25-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_contour_filled" class="section level3">
<h3><code>geom_contour_filled()</code></h3>
<pre class="r"><code>ggplot(seals, aes(long, lat)) + 
  geom_contour_filled(aes(z = z), binwidth =  0.2)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-26-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_contour_filled-1" class="section level3">
<h3><code>geom_contour_filled()</code></h3>
<pre class="r"><code>ggplot(seals, aes(long, lat)) + 
  stat_contour_filled(aes(z = z), bins =  5)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-27-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="在x上对y进行summary并作图" class="section level2">
<h2>在x上对y进行summary并作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>、<strong>y</strong></li>
<li><strong>fun.data</strong>：一个函数，输入是<strong>y</strong>，输出y、ymin和ymax</li>
<li><strong>fun.y</strong>、<strong>fun.ymin</strong>和<strong>fun.ymax</strong>：与<strong>fun.data</strong>同理</li>
<li><strong>fun.args</strong>：上述函数的参数</li>
<li><strong>binwidth</strong>：对<strong>x</strong>进行bin的宽度</li>
<li><strong>bins</strong>：对<strong>x</strong>进行bin的数量</li>
<li><strong>breaks</strong>：直接设定每次bin的范围，该参数会覆盖以上所有参数</li>
<li><code>stat_summary()</code>和<code>stat_summary_bin()</code>都是默认<code>geom_pointrange()</code></li>
<li><code>stat_summary()</code>对每个<strong>x</strong>进行summary，而<code>stat_summary_bin()</code>对binned的<strong>x</strong>进行summary</li>
</ul>
<div id="stat_summary" class="section level3">
<h3><code>stat_summary()</code></h3>
<pre class="r"><code>func &lt;- function(y) {
  data.frame(
    y = mean(y) + 0.1,
    ymax = max(y) + 1,
    ymin = min(y) - 1
  )
}
ggplot(mpg, aes(cty, hwy)) + 
  stat_summary(fun.data = func) +
  geom_point(colour = &quot;red&quot;, size = 1)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-28-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_summary_bin" class="section level3">
<h3><code>stat_summary_bin()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_summary_bin(fun.data = func, binwidth = 2) +
  geom_point(colour = &quot;red&quot;, size = 1)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-29-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="在x和y上对z进行summary并作图" class="section level2">
<h2>在x和y上对z进行summary并作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>、<strong>y</strong>、<strong>z</strong></li>
<li><strong>binwidth</strong>：给出每个小区域的<code>c(水平方向长度, 竖直方向长度)</code></li>
<li><strong>bins</strong>：给出<code>c(水平方向小区域块的数量, 竖直方向小区域块的数量)</code></li>
<li><strong>drop</strong>：是否不显示<strong>fun</strong>的返回值是NA的位置</li>
<li><strong>fun</strong>：对<strong>z</strong>进行统计的函数</li>
<li><strong>fun.args</strong>：函数的参数</li>
<li><code>stat_summary_2d()</code>是三维版的<code>stat_summary()</code>，而<code>stat_summary_hex()</code>又是hex版的<code>stat_summary_2d()</code></li>
</ul>
<div id="stat_summary_2d" class="section level3">
<h3><code>stat_summary_2d()</code></h3>
<pre class="r"><code>ggplot(seals, aes(long, lat)) + 
  stat_summary_2d(aes(z = z), binwidth = c(2, 1),fun = mean)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-30-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_summary_hex" class="section level3">
<h3><code>stat_summary_hex()</code></h3>
<pre class="r"><code>ggplot(seals, aes(long, lat)) + 
  stat_summary_hex(aes(z = z), binwidth = c(2, 1), fun = max)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-31-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="通过x和函数fun计算yfunx并绘制曲线" class="section level2">
<h2>通过x和函数fun()计算y=fun(x)并绘制曲线</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong></li>
<li><strong>fun</strong>：函数名</li>
<li><strong>xlim</strong>：函数的定义域</li>
<li><strong>n</strong>：用来绘制曲线的点的个数</li>
<li><strong>args</strong>：函数的参数</li>
</ul>
<div id="stat_function" class="section level3">
<h3><code>stat_function()</code></h3>
<pre class="r"><code>ggplot(data.frame(x = -10:10)) + 
  stat_function(aes(x), n = 99, fun = sin, xlim = c(-10,10))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-32-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="计算并绘制x的经验累计分布函数" class="section level2">
<h2>计算并绘制x的经验累计分布函数</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong></li>
<li><strong>n</strong>：插值的数量，大于样本呢数就没什么意义了</li>
<li><code>stat_ecdf()</code>的<strong>geom</strong>参数默认值是“step”</li>
</ul>
<div id="stat_ecdf" class="section level3">
<h3><code>stat_ecdf()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty)) + 
  stat_ecdf(n = NULL)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-33-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="计算并绘制q-q图" class="section level2">
<h2>计算并绘制Q-Q图</h2>
<hr />
<ul>
<li><strong>distribution</strong>：密度分布函数</li>
<li><strong>dparams</strong>：密度分布函数的参数</li>
</ul>
<div id="stat_qq和stat_qq_line" class="section level3">
<h3><code>stat_qq()</code>和<code>stat_qq_line()</code></h3>
<pre class="r"><code>dat &lt;- data.frame(x = rnorm(100))
ggplot(dat) + 
  stat_qq(aes(sample = x), distribution = qnorm, dparams = list()) + 
  stat_qq_line(aes(sample = x), distribution = qnorm, dparams = list()) </code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-34-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_qq和geom_qq_line" class="section level3">
<h3><code>geom_qq()</code>和<code>geom_qq_line()</code></h3>
<pre class="r"><code>ggplot(mpg) + 
  geom_qq(aes(sample = hwy)) + 
  geom_qq_line(aes(sample = hwy))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-35-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="二维核密度估计并作图" class="section level2">
<h2>二维核密度估计并作图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li>具体原理 ##TODO</li>
</ul>
<div id="stat_density_2d" class="section level3">
<h3><code>stat_density_2d()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_density_2d(contour = TRUE, n = 100)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-36-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_density_2d_filled" class="section level3">
<h3><code>stat_density_2d_filled()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  stat_density_2d_filled(contour = TRUE, n = 100)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-37-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_density_2d" class="section level3">
<h3><code>geom_density_2d()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_density_2d()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-38-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_density_2d_filled" class="section level3">
<h3><code>geom_density_2d_filled()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_density_2d_filled()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-39-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制空的坐标系" class="section level2">
<h2>绘制空的坐标系</h2>
<hr />
<ul>
<li>无参数</li>
</ul>
<div id="geom_blank" class="section level3">
<h3><code>geom_blank()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + geom_blank()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-40-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制带箭头曲线直线" class="section level2">
<h2>绘制带箭头曲线/直线</h2>
<hr />
<ul>
<li><code>aes()</code> 必须参数：<strong>x</strong>、<strong>y</strong>、<strong>xend</strong>、<strong>yend</strong></li>
<li><strong>curvature</strong>：曲线的曲率，正数向右，负数向左，曲率越大曲线弯曲程度越大，必须为一个数字，我也不知道为什么</li>
<li><strong>angle</strong>：偏度，取值“0”到“180”，越小曲线越偏向起始点，可以为向量</li>
<li><strong>ncp</strong>：用来画曲线使用的点的个数，越多曲线越平滑</li>
<li><strong>arrow</strong>：通过<code>arrow()</code>创建一个arrow对象进行赋值
<ul>
<li><strong>angle</strong>：为箭头与曲线的夹角</li>
<li><strong>length</strong>：一个unit对象，通过<code>unit()</code>生成</li>
<li><strong>ends</strong>为箭头位置，可以为“first”、“last”或“both”</li>
<li><strong>type</strong>为箭头类型，可以为“open”、“closed”</li>
</ul></li>
<li><strong>arrow.fill</strong>：当<strong>arrow</strong>的<strong>type</strong>是“closed”时可选择填充颜色</li>
<li><strong>lineend</strong>：线的终点的样式，可选“round”，“butt”, “square”</li>
<li><strong>linejoin</strong>：线的转折或者说连接处的样式，可选“round”，“mitre”，“bevel”</li>
<li><code>geom_segment()</code>其实就是<strong>curvature</strong>为“0”、<strong>angle</strong>为“90”的<code>geom_curve()</code></li>
</ul>
<div id="geom_curve" class="section level3">
<h3><code>geom_curve()</code></h3>
<pre class="r"><code>dat &lt;- tibble(long = c(10, 12), lat = c(10, 12))
ggplot(dat, aes(long, lat)) + 
  geom_curve(
    aes(yend = lat + 1, xend = long + 1),
    curvature = 0.5,
    angle = c(45, 135),
    ncp = 5,
    arrow = arrow(angle = 30, length = unit(0.1, &quot;inches&quot;),
                  ends = &quot;last&quot;, type = &quot;closed&quot;),
    arrow.fill = &quot;red&quot;,
    lineend = &quot;butt&quot;
  )</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-41-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_segment" class="section level3">
<h3><code>geom_segment()</code></h3>
<pre class="r"><code>ggplot(dat, aes(long, lat)) + 
  geom_segment(
    aes(yend = lat + 1, xend = long + 1),
    arrow = arrow(angle = 30, length = unit(0.25, &quot;inches&quot;),
                  ends = &quot;both&quot;, type = &quot;closed&quot;),
    arrow.fill = &quot;green&quot;,
    lineend = &quot;butt&quot;,
    linejoin = &quot;round&quot;
  )</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-42-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制折线" class="section level2">
<h2>绘制折线</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>、<strong>y</strong></li>
<li><strong>direction</strong>：阶梯的方向，“hv”为先水平后竖直，“vh”为先竖直后水平</li>
<li><strong>arrow</strong>：通过<code>arrow()</code>创建一个arrow对象进行赋值</li>
<li><strong>lineend</strong>：线的终点的样式，可选“round”，“butt”, “square”</li>
<li><strong>linejoin</strong>：线的转折或者说连接处的样式，可选“round”，“mitre”，“bevel”</li>
<li><strong>linemitre</strong>：线的转折/连接处的宽度，这三个参数在正常size的线下几乎没有什么作用</li>
<li><code>geom_path()</code>按照数据顺序连接各点；<code>geom_line()</code>按照从左到右连接各点；<code>geom_step()</code>用阶梯连接各点</li>
<li>对于NA的处理方式：
<ul>
<li>NA出现在数据中间：<code>geom_path()</code>会断开，无论<strong>na.rm</strong>是“TRUE”还是“FALSE”；<code>geom_line()</code>会删除NA并警告；<code>geom_step()</code>会删除NA无警告</li>
<li>NA出现在数据开始或结束：如果<strong>na.rm</strong>为“TRUE”，删除NA无警告；如果<strong>na.rm</strong>为“FALSE”，删除NA有警告</li>
</ul></li>
</ul>
<div id="geom_path" class="section level3">
<h3><code>geom_path()</code></h3>
<pre class="r"><code>dat &lt;- tibble(long = c(1,5,4,3,2), lat = c(1,1,2,3,2))
ggplot(dat, aes(long, lat)) + geom_path()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-43-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_line" class="section level3">
<h3><code>geom_line()</code></h3>
<pre class="r"><code>ggplot(dat, aes(long, lat)) + geom_line()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-44-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_step" class="section level3">
<h3><code>geom_step()</code></h3>
<pre class="r"><code>ggplot(dat, aes(long, lat)) + geom_step(direction = &quot;hv&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-45-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制多边形" class="section level2">
<h2>绘制多边形</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>、<strong>y</strong></li>
<li><strong>rule</strong>：“evenodd”或“winding”，具体意义 ##TODO</li>
<li><code>geom_polygon()</code>是在<code>geom_path()</code>的基础上，连接第一个点与最后一个点，然后用颜色填充中间围起来的部分，点的数据够多的话能画任意图像</li>
</ul>
<div id="geom_polygon" class="section level3">
<h3><code>geom_polygon()</code></h3>
<pre class="r"><code>ids &lt;- factor(c(&quot;1.1&quot;, &quot;2.1&quot;, &quot;1.2&quot;, &quot;2.2&quot;, &quot;1.3&quot;, &quot;2.3&quot;))
values &lt;- data.frame(
  id = ids,
  value = c(3, 3.1, 3.1, 3.2, 3.15, 3.5)
)
positions &lt;- data.frame(
  id = rep(ids, each = 4),
  x = c(2, 1, 1.1, 2.2, 1, 0, 0.3, 1.1, 2.2, 1.1, 1.2, 2.5, 1.1,
        0.3, 0.5, 1.2, 2.5, 1.2, 1.3, 2.7, 1.2, 0.5, 0.6, 1.3),
  y = c(-0.5, 0, 1, 0.5, 0, 0.5, 1.5, 1, 0.5, 1, 2.1, 1.7, 1, 1.5,
        2.2, 2.1, 1.7, 2.1, 3.2, 2.8, 2.1, 2.2, 3.3, 3.2)
)
datapoly &lt;- merge(values, positions, by = c(&quot;id&quot;))
ggplot(datapoly, aes(x = x, y = y)) +
  geom_polygon(aes(fill = value, group = id)) + 
  geom_point(colour = &quot;red&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-46-1.png" width="50%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>holes &lt;- do.call(
  rbind, 
  lapply(
    split(datapoly, datapoly$id),
    function(df) {
      df$x &lt;- df$x + 0.5 * (mean(df$x) - df$x)
      df$y &lt;- df$y + 0.5 * (mean(df$y) - df$y)
      df
    }
  )
)
datapoly$subid &lt;- 1L
holes$subid &lt;- 2L
datapoly &lt;- rbind(datapoly, holes)
ggplot(datapoly, aes(x = x, y = y)) +
  geom_polygon(aes(fill = value, group = id, subgroup = subid), rule = &quot;evenodd&quot;) +
  geom_point(aes(colour = as.factor(subid)))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-47-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制长方形" class="section level2">
<h2>绘制长方形</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：
<ul>
<li><code>geom_rect()</code>：<strong>xmin</strong>、<strong>ymin</strong>、<strong>xmax</strong>、<strong>ymax</strong></li>
<li><code>geom_raster()</code>：<strong>x</strong>、<strong>y</strong></li>
<li><code>geom_tile()</code>：<strong>x</strong>、<strong>y</strong></li>
</ul></li>
<li><strong>hjust</strong>和<strong>vjust</strong>：在<code>geom_raster()</code>中确定长方形位置，“(0, 0)”为左下角，“(1, 1)”为右上角</li>
<li><strong>width</strong>和<strong>height</strong>：在<code>geom_tile()</code>中确定长方形的宽(x轴长度)和高(y轴长度)</li>
<li><strong>linejoin</strong>：线的转折或者说连接处的样式，可选“round”，“mitre”，“bevel”</li>
<li><strong>interpolate</strong>：原理不明，为TRUE的话方格之间的衔接显得更加平滑</li>
<li><code>geom_rect()</code>的可操作性最强；<code>geom_raster()</code>适合点距相同的图；<code>geom_tile()</code>的长方形大小一样，且点都在长方形正中间</li>
<li><code>geom_raster()</code>和<code>geom_tile()</code>可通过<code>aes(fill)</code>在二维平面上描述三维数据</li>
</ul>
<div id="geom_rect" class="section level3">
<h3><code>geom_rect()</code></h3>
<pre class="r"><code>dat &lt;- tibble(long = c(10, 12, 15), lat = c(10, 12, 15))
ggplot(dat) + 
  geom_rect(aes(xmin = long - 2, ymin = lat - 2, xmax = long + 2, ymax = lat + 2), alpha = 0.5) +
  geom_point(aes(long, lat), colour = &quot;red&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-48-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_raster" class="section level3">
<h3><code>geom_raster()</code></h3>
<pre class="r"><code>ggplot(dat, aes(long, lat)) +
  geom_raster(hjust = 1, vjust = 1, alpha = 0.5) +
  geom_point(colour = &quot;red&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-49-1.png" width="50%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>seals$z &lt;- sqrt(seals$long^2 + seals$lat^2)
ggplot(seals, aes(long, lat)) + 
  geom_raster(aes(fill = z), hjust = 0.5, vjust = 0.5, interpolate = TRUE)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-50-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_tile" class="section level3">
<h3><code>geom_tile()</code></h3>
<pre class="r"><code>ggplot(dat, aes(long, lat)) +
  geom_tile(width = 4, height = 4, alpha = 0.5) +
  geom_point(colour = &quot;red&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-51-1.png" width="50%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(seals, aes(long, lat)) + geom_tile(aes(fill = z))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-52-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制区域" class="section level2">
<h2>绘制区域</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：
<ul>
<li><code>geom_ribbon()</code>：<strong>x</strong>、<strong>ymin</strong>、<strong>ymax</strong></li>
<li><code>geom_area()</code>：<strong>x</strong>、<strong>y</strong></li>
</ul></li>
<li><code>geom_area()</code>就是<strong>ymin</strong>为0，<strong>ymax</strong>为<strong>y</strong>的<code>geom_ribbon()</code></li>
</ul>
<div id="geom_ribbon" class="section level3">
<h3><code>geom_ribbon()</code></h3>
<pre class="r"><code>ggplot(economics, aes(date, unemploy)) + 
  geom_ribbon(aes(ymin = unemploy - 900, ymax = unemploy + 900))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-53-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_area" class="section level3">
<h3><code>geom_area()</code></h3>
<pre class="r"><code>ggplot(economics, aes(date, unemploy)) + geom_area()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-54-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制直线" class="section level2">
<h2>绘制直线</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：
<ul>
<li><code>geom_abline()</code>：<strong>intercept</strong>、<strong>slope</strong></li>
<li><code>geom_hline()</code>：<strong>yintercept</strong></li>
<li><code>geom_vline()</code>：<strong>xintercept</strong></li>
</ul></li>
</ul>
<div id="geom_ablinegeom_hline和geom_vline" class="section level3">
<h3><code>geom_abline()</code>、<code>geom_hline()</code>和<code>geom_vline()</code></h3>
<pre class="r"><code>ggplot() + 
  geom_abline(aes(intercept = 0, slope = 1)) +
  geom_hline(aes(yintercept = 1)) +
  geom_vline(aes(xintercept = 1))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-55-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="添加标签文本" class="section level2">
<h2>添加标签/文本</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong>，<strong>label</strong></li>
<li><strong>nudge_x</strong>和<strong>nudge_y</strong>：偏移，向右向上为正，向左向下为负</li>
<li><strong>label.padding</strong>：<code>geom_label()</code>背景的大小</li>
<li><strong>label.r</strong>：<code>geom_label()</code>背景四个角的圆滑程度</li>
<li><strong>label.size</strong>：<code>geom_label()</code>背景边缘线的粗细</li>
<li><strong>check_overlap</strong>：<code>geom_text()</code>是否删除重叠的文本</li>
<li><code>geom_label()</code>和<code>geom_text()</code>都是在每一个点上打标签，如果只是某个点的话考虑用<code>annotate()</code></li>
</ul>
<div id="geom_label" class="section level3">
<h3><code>geom_label()</code></h3>
<pre class="r"><code>dat &lt;- tibble(
  long = c(10:13), lat = c(10:13), 
  lb = c(NA, &quot;FANG&quot;, &quot;GONG&quot;, NA)
)
ggplot(dat, aes(long, lat)) + 
  geom_label(
    aes(label = lb), nudge_x = 0.3, nudge_y = 0.3,
    label.padding = unit(0.5, &quot;lines&quot;),
    label.r = unit(0.5, &quot;lines&quot;), label.size = 0.5
  ) +
  geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-56-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_text" class="section level3">
<h3><code>geom_text()</code></h3>
<pre class="r"><code>ggplot(dat, aes(long, lat)) + 
  geom_text(aes(label = lb))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-57-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制偏离原位置的点" class="section level2">
<h2>绘制偏离原位置的点</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li><strong>height</strong>和<strong>width</strong>：偏离的范围，在水平方向可以向左或向右<strong>width</strong>的距离，在竖直方向可以向上或向下<strong>height</strong>的距离</li>
</ul>
<div id="geom_jitter" class="section level3">
<h3><code>geom_jitter()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_jitter(height = 2, width = 2) + 
  geom_point(colour = &quot;red&quot;)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-58-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制散点图" class="section level2">
<h2>绘制散点图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
</ul>
<div id="geom_point" class="section level3">
<h3><code>geom_point()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-59-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="在图的四周绘制点的一维投影" class="section level2">
<h2>在图的四周绘制点的一维投影</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong></li>
<li><strong>outside</strong>：是否投射在坐标轴外部</li>
<li><strong>sides</strong>：投射方向，用“trbl”来代表“top”，“right”，“bottom”，“left”</li>
<li><strong>length</strong>：描述投射位置的小短线的长度</li>
</ul>
<div id="geom_rug" class="section level3">
<h3><code>geom_rug()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) + 
  geom_rug(outside = FALSE, sides = &quot;tbl&quot;, length = unit(0.1, &quot;npc&quot;))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-60-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制区间" class="section level2">
<h2>绘制区间</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y</strong>，<strong>ymin</strong>，<strong>ymax</strong></li>
<li><strong>fatten</strong>：中间那根线有多粗，数字越大越粗</li>
<li><code>geom_crossbar()</code>是个日字，<code>geom_errorbar()</code>是个I字，<code>geom_linerange()</code>是一条线，<code>geom_pointrange()</code>是线中间有个点</li>
</ul>
<div id="geom_crossbar" class="section level3">
<h3><code>geom_crossbar()</code></h3>
<pre class="r"><code>df &lt;- tibble(grp = c(&quot;A&quot;, &quot;B&quot;), fit = 4:5, se = 1:2)
ggplot(df, aes(grp, fit, ymin = fit-se, ymax = fit+se)) + geom_crossbar(fatten = 2)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-61-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_errorbar" class="section level3">
<h3><code>geom_errorbar()</code></h3>
<pre class="r"><code>ggplot(df, aes(grp, fit, ymin = fit-se, ymax = fit+se)) + geom_errorbar()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-62-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_linerange" class="section level3">
<h3><code>geom_linerange()</code></h3>
<pre class="r"><code>ggplot(df, aes(grp, fit, ymin = fit-se, ymax = fit+se)) + geom_linerange()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-63-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_pointrange" class="section level3">
<h3><code>geom_pointrange()</code></h3>
<pre class="r"><code>ggplot(df, aes(grp, fit, ymin = fit-se, ymax = fit+se)) + geom_pointrange()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-64-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制地图" class="section level2">
<h2>绘制地图</h2>
<hr />
<div id="geom_map" class="section level3">
<h3><code>geom_map()</code></h3>
<pre class="r"><code>data &lt;- data.frame(
  murder = USArrests$Murder,
  state = tolower(rownames(USArrests))
)
map &lt;- map_data(&quot;state&quot;)
ggplot(data, aes(fill = murder)) + 
  geom_map(aes(map_id = state), map = map) +
  expand_limits(x = map$long, y = map$lat)</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-65-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="绘制点阵图" class="section level2">
<h2>绘制点阵图</h2>
<hr />
<ul>
<li><code>aes()</code>必须参数：<strong>x</strong>，<strong>y(count, ncount)</strong></li>
</ul>
<div id="geom_dotplot" class="section level3">
<h3><code>geom_dotplot()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(hwy)) + geom_dotplot()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-66-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="不明白作用的函数" class="section level2">
<h2>不明白作用的函数</h2>
<hr />
<div id="geom_spoke" class="section level3">
<h3><code>geom_spoke()</code></h3>
<pre class="r"><code>ggplot(seals, aes(x = long, y = lat)) + geom_spoke(aes(angle = 1:1155, radius = 1))</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-67-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_ellipse" class="section level3">
<h3><code>stat_ellipse()</code></h3>
<pre class="r"><code>ggplot(mpg, aes(cty, hwy)) +
  stat_ellipse(type = &quot;t&quot;, level = 0.95, segments = 51) +
  geom_point()</code></pre>
<p><img src="/posts/20210323_ggplot2_stat_geom_files/figure-html/unnamed-chunk-68-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
